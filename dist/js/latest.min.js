function cron(){}$("#login").submit((function(e){let display=function(msg,subject="valid"){if(subject=="invalid"){$("#hash").addClass("is-invalid");$(".input-section .feedback").addClass("invalid-feedback")}else if(subject=="valid"){$("#hash").addClass("is-valid");$(".input-section .feedback").addClass("valid-feedback")}$(".input-section .feedback").html(msg);$(".input-section .feedback").show()};let login_alert=function(msg){$(".inner-form .headline-section").after('<div class="alert alert-dismissible alert-danger">                    <strong>Error:</strong> '+msg+"                  </div>")};e.preventDefault();if($(".inner-form .alert").length>2){$(".inner-form .alert").last().remove()}$("#submit").prop("disabled",true);let result=$.post(site.sub_path+"ajax/login",{hash:$("#hash").val()});result.done((function(d){$(".inner-form .alert").last().remove();if(d.status=="ok"&&d.data.auth=="ok"){display("Successful login","valid");window.location.href=site.sub_path+"dashboard"}else if(d.status=="ok"&&d.data.auth=="failed"){display("Unknown hash.","invalid")}else{login_alert("Request rejected.")}}));result.fail((function(){login_alert("Ajax request failed.")}));$("#submit").prop("disabled",false)}));$(".input-section input[name=login_hash]").focus((function(){$(".input-section .feedback").hide();$(".input-section .feedback").html();$(this).removeClass("is-invalid");$(this).removeClass("is-valid")}));$("#logout").click((function(e){e.preventDefault();$("#logout").prop("disabled",true);let result=$.post(site.sub_path+"ajax/logout",{});result.done((function(d){if(d.status=="ok"&&d.data.logout=="ok"){window.location.href=site.sub_path+"login"}else if(d.status=="ok"&&d.data.logout=="failed"){alert("Logout request failed.")}else{alert("Logout request rejected.")}}));result.fail((function(){alert("Logout ajax request failed.")}));$("#logout").prop("disabled",false)}));function statusbar(datestring="",status=0){date=new Date(datestring);now=new Date;let bar="#dashboard-head .user-section .info-tab";pill=function(bar,txt,cls){$(bar+" .status-pill").html(txt);$(bar+" .status-pill").removeClass("badge-secondary");$(bar+" .status-pill").removeClass("badge-danger");$(bar+" .status-pill").removeClass("badge-warning");$(bar+" .status-pill").removeClass("badge-success");$(bar+" .status-pill").addClass("badge-"+cls)};txt=function(bar,txt){$(bar+" .status-text").html(txt)};case_day=function(n,d){today=n.getFullYear()+n.getMonth()+n.getDate();thatday=d.getFullYear()+d.getMonth()+d.getDate();if(today==thatday){return"today"}else if(today-1==thatday){return"yesterday"}else{return"else"}};current_time=function(d){string="";if(d.getHours()<10){string="0"+d.getHours()}else{string=d.getHours()}string=string+":";if(d.getMinutes()<10){string=string+"0"+d.getMinutes()}else{string=string+d.getMinutes()}return string};minutes_ago=function(n,d){return Math.round((n.getTime()-d.getTime())/(1e3*60))};switch(status){case 0:txt(bar,"Status unknown.");pill(bar,"Unknown","secondary");break;case 1:txt(bar,"Last update "+minutes_ago(now,date)+" minutes ago. "+case_day(now,date)+" at "+current_time(date)+".");pill(bar,"Up to date","success");break;case 2:txt(bar,"Last update "+Math.round(minutes_ago(now,date)/60)+" hours ago. "+case_day(now,date)+" at "+current_time(date)+".");pill(bar,"Nearly outdated","warning");break;case 3:day=case_day(now,date);if(day=="today"||day=="yesterday"){txt(bar,"Last update "+day+" at "+current_time(date)+".")}else{txt(bar,"Last update "+date.toLocaleDateString()+" at "+current_time(date)+".")}pill(bar,"Outdated","danger");break}}